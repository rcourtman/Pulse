<!DOCTYPE html>
<html lang="en" class="scrollbar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pulse</title>
  
  <!-- Modern favicon setup -->
  <link rel="icon" href="/logo.svg" type="image/svg+xml">
  <link rel="icon" href="/favicon.ico" sizes="32x32">
  <link rel="apple-touch-icon" href="/logo.svg">
  
  <!-- PWA & Modern Web App -->
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#2563eb" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#3b82f6" media="(prefers-color-scheme: dark)">
  
  <link rel="stylesheet" href="/output.css">
  <style>
    /* Radio button styles for unified backups tab */
    #unified-backup-all:checked ~ label[for="unified-backup-all"],
    #unified-backup-snapshot:checked ~ label[for="unified-backup-snapshot"],
    #unified-backup-local:checked ~ label[for="unified-backup-local"],
    #unified-backup-remote:checked ~ label[for="unified-backup-remote"] {
        background-color: rgb(219, 234, 254);
        color: rgb(29, 78, 216);
    }
    
    .dark #unified-backup-all:checked ~ label[for="unified-backup-all"],
    .dark #unified-backup-snapshot:checked ~ label[for="unified-backup-snapshot"],
    .dark #unified-backup-local:checked ~ label[for="unified-backup-local"],
    .dark #unified-backup-remote:checked ~ label[for="unified-backup-remote"] {
        background-color: rgba(30, 64, 175, 0.5);
        color: rgb(147, 197, 253);
    }
    
    #unified-all:checked ~ label[for="unified-all"],
    #unified-vm:checked ~ label[for="unified-vm"],
    #unified-lxc:checked ~ label[for="unified-lxc"] {
        background-color: rgb(219, 234, 254);
        color: rgb(29, 78, 216);
    }
    
    .dark #unified-all:checked ~ label[for="unified-all"],
    .dark #unified-vm:checked ~ label[for="unified-vm"] {
        background-color: rgba(30, 64, 175, 0.5);
        color: rgb(147, 197, 253);
    }
    
    #unified-lxc:checked ~ label[for="unified-lxc"] {
        background-color: rgb(220, 252, 231);
        color: rgb(21, 128, 61);
    }
    
    .dark #unified-lxc:checked ~ label[for="unified-lxc"] {
        background-color: rgba(20, 83, 45, 0.5);
        color: rgb(134, 239, 172);
    }
    
    #unified-status-all:checked ~ label[for="unified-status-all"],
    #unified-status-verified:checked ~ label[for="unified-status-verified"],
    #unified-status-unverified:checked ~ label[for="unified-status-unverified"] {
        background-color: rgb(219, 234, 254);
        color: rgb(29, 78, 216);
    }
    
    .dark #unified-status-all:checked ~ label[for="unified-status-all"],
    .dark #unified-status-verified:checked ~ label[for="unified-status-verified"],
    .dark #unified-status-unverified:checked ~ label[for="unified-status-unverified"] {
        background-color: rgba(30, 64, 175, 0.5);
        color: rgb(147, 197, 253);
    }
    
    @keyframes pulse {
      0%, 100% {
        opacity: 1;
        transform: scale(1);
      }
      50% {
        opacity: 0.7;
        transform: scale(1.1);
      }
    }
    .pulse-logo-circle {
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
      transform-origin: center;
    }
    /* Updated to match new logo design */
    .pulse-logo { width: 100%; height: 100%; }
    .pulse-bg { fill: #2563eb; }
    .pulse-ring { fill: none; stroke: #ffffff; stroke-width: 14; opacity: 0.92; }
    .pulse-center { fill: #ffffff; }
    .dark .pulse-bg { fill: #3b82f6; }
    .dark .pulse-ring { stroke: #dbeafe; }
    .dark .pulse-center { fill: #dbeafe; }
    
    /* Fixed table column widths to prevent shifting */
    #main-table {
      table-layout: fixed !important;
    }
    
    #main-table td {
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    /* Force all sticky cells in tables to be opaque */
    td.sticky.left-0 {
      background-clip: padding-box;
    }
    
    /* Only apply nowrap to specific cells that need it */
    #main-table td:nth-child(1),
    #main-table td:nth-child(2),
    #main-table td:nth-child(3),
    #main-table td:nth-child(4),
    #main-table td:nth-child(8),
    #main-table td:nth-child(9),
    #main-table td:nth-child(10),
    #main-table td:nth-child(11) {
      white-space: nowrap;
    }
    
    /* Ensure metric cells don't expand */
    #main-table td:nth-child(5),
    #main-table td:nth-child(6),
    #main-table td:nth-child(7),
    #main-table td:nth-child(8),
    #main-table td:nth-child(9),
    #main-table td:nth-child(10),
    #main-table td:nth-child(11) {
      overflow: hidden;
    }
    
    /* Ensure progress bars don't affect layout */
    #main-table .metric-text,
    #main-table .metric-chart {
      overflow: hidden;
    }
    
    /* Fix dropdowns in alert mode */
    #main-table select {
      width: 100%;
      max-width: 100%;
    }

    /* Custom Slider Thumb Styles - moved to src/index.css for better control */

    /* PBS namespace dropdown styling */
    select optgroup {
        font-weight: bold;
        color: #6b7280; /* gray-500 */
        background-color: #f3f4f6; /* gray-100 */
        font-style: normal;
        padding: 4px 8px;
    }
    .dark select optgroup {
        color: #9ca3af; /* gray-400 */
        background-color: #374151; /* gray-700 */
    }
    select optgroup option {
        font-weight: normal;
        padding-left: 16px;
        color: #111827; /* gray-900 */
        background-color: white;
    }
    .dark select optgroup option {
        color: #f3f4f6; /* gray-100 */
        background-color: #1f2937; /* gray-800 */
    }


    /* Style for header when threshold is active */
    .threshold-active-header {
        @apply font-semibold;
    }


    /* Dot animation for logging indicator */
    @keyframes dot-pulse {
      0%, 100% { opacity: 0.2; }
      50% { opacity: 1; }
    }
    .dot-animate {
      animation: dot-pulse 1.4s infinite ease-in-out;
      display: inline-block; /* Needed for animation */
      width: 0.25em; /* Adjust spacing slightly */
    }
    .dot-animate:nth-child(1) { animation-delay: 0s; }
    .dot-animate:nth-child(2) { animation-delay: 0.2s; }
    .dot-animate:nth-child(3) { animation-delay: 0.4s; }

    /* Subtle pattern for empty threshold cells */
    .threshold-pattern-bg {
        background-image: linear-gradient(45deg, rgba(0, 0, 0, 0.05) 25%, transparent 25%, transparent 50%, rgba(0, 0, 0, 0.05) 50%, rgba(0, 0, 0, 0.05) 75%, transparent 75%, transparent);
        background-size: 10px 10px;
    }
    .dark .threshold-pattern-bg {
        background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.04) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.04) 50%, rgba(255, 255, 255, 0.04) 75%, transparent 75%, transparent);
    }

    /* Mini Chart Styles */
    .usage-chart-container {
        position: relative;
        overflow: hidden;
        border-radius: 3px;
        background: rgba(0, 0, 0, 0.02);
        height: 20px;
        width: 100%;
        margin: 0;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .dark .usage-chart-container {
        background: rgba(255, 255, 255, 0.02);
    }
    
    .sparkline-container {
        position: relative;
        overflow: hidden;
        border-radius: 2px;
        background: rgba(0, 0, 0, 0.03);
        height: 16px;
        width: 100%;
        margin: 0;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .dark .sparkline-container {
        background: rgba(255, 255, 255, 0.03);
    }
    
    .mini-chart {
        display: block;
        width: 100%;
        height: 100%;
    }
    
    .mini-chart path {
        stroke-linecap: round;
        stroke-linejoin: round;
        transition: d 0.3s ease-out, stroke-dasharray 0.3s ease-out;
    }

    /* Charts mode styling */
    .charts-mode #main-table .usage-col,
    .charts-mode #main-table .net-disk-col {
        /* Removed text-align: center to keep metrics left-aligned */
    }
    
    /* Reduce padding in charts mode to maximize chart space */
    .charts-mode #main-table .usage-col,
    .charts-mode #main-table .net-disk-col {
        padding: 2px 4px;
    }
    
    .charts-mode .metric-text {
        display: none;
    }
    
    .charts-mode .metric-chart {
        display: block;
    }
    
    .metric-chart {
        display: none;
    }

    /* Charts mode indicator */
    .charts-mode {
        /* Chart mode styles handled by checkbox state */
    }

    /* Enhanced metric cell layouts */
    .usage-col {
        min-width: 100px;
    }
    
    .net-disk-col {
        min-width: 60px;
    }

    /* Alerts mode styling */
    .alerts-mode .metric-text {
        display: none;
    }
    
    .alerts-mode .metric-chart {
        display: none;
    }
    
    .alerts-mode .alert-threshold-input {
        display: flex !important;
        padding: 0;
        align-items: center;
    }
    
    
    .alert-threshold-input {
        display: none;
    }
    
    /* Disable sticky positioning in alerts mode to fix Chrome jittering bug */
    .alerts-mode .sticky {
        position: relative !important;
        left: auto !important;
    }
    
    /* Disable transitions when switching modes to prevent height jumping */
    .switching-modes * {
        transition: none !important;
    }
    
    /* Alert threshold slider styling */
    .alert-threshold-slider {
        -webkit-appearance: none;
        appearance: none;
        background: transparent;
        cursor: pointer;
    }
    
    .alert-threshold-slider::-webkit-slider-track {
        background: #e5e7eb;
        height: 8px;
        border-radius: 4px;
    }
    
    .dark .alert-threshold-slider::-webkit-slider-track {
        background: #374151;
    }
    
    .alert-threshold-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        height: 16px;
        width: 16px;
        border-radius: 50%;
        background: #3b82f6;
        border: 2px solid #ffffff;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        cursor: pointer;
    }
    
    .dark .alert-threshold-slider::-webkit-slider-thumb {
        border-color: #1f2937;
    }
    
    .alert-threshold-slider::-moz-range-track {
        background: #e5e7eb;
        height: 8px;
        border-radius: 4px;
        border: none;
    }
    
    .dark .alert-threshold-slider::-moz-range-track {
        background: #374151;
    }
    
    .alert-threshold-slider::-moz-range-thumb {
        height: 16px;
        width: 16px;
        border-radius: 50%;
        background: #3b82f6;
        border: 2px solid #ffffff;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        border: none;
    }
    
    .dark .alert-threshold-slider::-moz-range-thumb {
        border: 2px solid #1f2937;
    }
    
    /* Alert threshold select styling */
    .alert-threshold-select {
        font-size: 11px;
        padding: 2px 4px;
        min-height: auto;
    }
    
    .alert-threshold-select:focus {
        outline: none;
        ring: 1px;
        ring-color: #3b82f6;
        border-color: #3b82f6;
    }
    
    /* Prevent text wrapping in all table cells */
    #main-table td,
    #main-table th {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    /* Special handling for name column to enable ellipsis */
    #main-table td:first-child {
        max-width: 250px;
    }
    
    /* Mobile table scroll styling */
    @media (max-width: 768px) {
        .table-container {
            -webkit-overflow-scrolling: touch;
            scroll-snap-type: x proximity;
        }
        .table-container::-webkit-scrollbar {
            height: 10px;
        }
        .table-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 5px;
        }
        .table-container::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
        }
        .dark .table-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }
        .dark .table-container::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
        }
    }
    
    /* Responsive column widths */
    #main-table td:nth-child(1) { min-width: var(--name-col-width); }
    #main-table td:nth-child(4) { min-width: var(--uptime-col-width); }
    
    #backups-overview-table td:nth-child(1) { min-width: var(--backup-name-col-width); }
    #backups-overview-table td:nth-child(4) { min-width: var(--backup-node-col-width); }
    #backups-overview-table td:nth-child(6) { min-width: var(--backup-pbs-col-width); }
    #backups-overview-table td:nth-child(7) { min-width: var(--backup-ds-col-width); }
    
    .pbs-datastore-table td:nth-child(1) { min-width: var(--pbs-name-col-width); }
    .pbs-datastore-table td:nth-child(2) { min-width: var(--pbs-path-col-width); }
    
    #storage-info-content table td:nth-child(1) { min-width: var(--storage-name-col-width); }
    #storage-info-content table td:nth-child(3) { min-width: var(--storage-type-col-width); }
    
    /* Mobile optimizations for tables */
    @media (max-width: 768px) {
        .table-container {
            position: relative;
        }
    }
    
    /* Settings modal tab scrolling on mobile */
    @media (max-width: 640px) {
        #settings-tabs {
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
        }
        
        #settings-tabs .settings-tab {
            white-space: nowrap;
            flex-shrink: 0;
        }
    }

    /* Mobile-specific PBS styles */
    .tap-target {
        min-height: 44px;
        min-width: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        touch-action: manipulation;
    }


    .mobile-task-card,
    .mobile-datastore-card,
    .mobile-task-detail-card {
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
    }

    .mobile-task-card:active,
    .mobile-datastore-card:active {
        transform: scale(0.98);
    }

    @media (max-width: 768px) {
        /* Hide desktop tables on mobile */
        .mobile-layout .overflow-x-auto table {
            display: none !important;
        }
        
        /* Show mobile containers */
        .mobile-layout .mobile-datastore-container,
        .mobile-layout .mobile-task-container,
        .mobile-layout .mobile-pbs-accordion {
            display: block !important;
        }
        
        /* Enhanced mobile scrolling */
        .mobile-layout .overflow-x-auto {
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
        }
        
        /* Mobile table scroll indicator */
        .mobile-layout .table-container::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            width: 20px;
            background: linear-gradient(to left, rgba(0,0,0,0.1), transparent);
            pointer-events: none;
            z-index: 5;
        }
        
        .dark .mobile-layout .table-container::after {
            background: linear-gradient(to left, rgba(255,255,255,0.1), transparent);
        }
        
        /* Mobile PBS tab improvements */
        .mobile-layout .pbs-tab-container {
            flex-wrap: wrap;
            gap: 2px;
        }
        
        .mobile-layout .pbs-tab-container button {
            flex: 1;
            min-width: 0;
            padding: 8px 12px;
            font-size: 0.75rem;
        }
        
        /* Mobile accordion animations */
        .mobile-pbs-accordion .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        
        .mobile-pbs-accordion .accordion-content.expanded {
            max-height: 2000px;
            transition: max-height 0.3s ease-in;
        }
        
        /* Mobile summary card grid */
        .mobile-pbs-summary {
            gap: 8px;
        }
        
        .summary-card {
            min-height: 70px;
        }
        
        /* Mobile task card enhancements */
        .mobile-task-card .tap-target {
            border-radius: 6px;
        }
        
        /* Mobile datastore progress bars */
        .mobile-datastore-card .progress-container {
            height: 8px;
        }
        
        /* Mobile text sizing adjustments */
        .mobile-layout .text-xs {
            font-size: 0.7rem;
        }
        
        .mobile-layout .text-sm {
            font-size: 0.8rem;
        }
        
        /* Mobile spacing improvements */
        .mobile-layout .space-y-2 > * + * {
            margin-top: 0.375rem;
        }
        
        .mobile-layout .space-y-3 > * + * {
            margin-top: 0.5rem;
        }
        
        .mobile-layout .space-y-4 > * + * {
            margin-top: 0.75rem;
        }
        
        /* Mobile error message handling */
        .mobile-task-detail-card .break-all {
            word-break: break-all;
            overflow-wrap: break-word;
            white-space: pre-wrap;
        }
        
        /* Mobile progress bar animations */
        .mobile-layout .transition-all {
            transition-property: all;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            transition-duration: 300ms;
        }
        
        /* Mobile focus states */
        .mobile-layout .tap-target:focus {
            outline: 2px solid rgba(59, 130, 246, 0.5);
            outline-offset: 2px;
        }
        
        /* Mobile dark mode adjustments */
        .dark .mobile-task-card,
        .dark .mobile-datastore-card {
            background-color: rgba(31, 41, 55, 0.7);
        }
        
        .dark .mobile-task-detail-card {
            background-color: rgba(127, 29, 29, 0.1);
        }
        
        /* Mobile accordion header styling */
        .mobile-pbs-accordion .tap-target {
            text-align: left;
            justify-content: flex-start;
        }
        
        /* Mobile chevron rotation */
        .mobile-pbs-accordion .chevron {
            transition: transform 0.2s ease;
        }
        
        .mobile-pbs-accordion .chevron.rotated {
            transform: rotate(180deg);
        }
        
        /* Mobile viewport adjustments */
        .mobile-layout {
            padding: 8px;
        }
        
        /* Mobile button improvements */
        .mobile-layout button {
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }
        
        /* Mobile scroll performance */
        .mobile-layout .space-y-2,
        .mobile-layout .space-y-3,
        .mobile-layout .space-y-4 {
            will-change: scroll-position;
        }
    }

    /* Tablet-specific adjustments */
    @media (min-width: 768px) and (max-width: 1024px) {
        .mobile-pbs-summary {
            grid-template-columns: repeat(4, 1fr);
        }
        
        .mobile-task-card,
        .mobile-datastore-card {
            max-width: none;
        }
    }

    /* High DPI display optimizations */
    @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
        .mobile-layout .border {
            border-width: 0.5px;
        }
    }
    
    /* Instant mode switching - no transitions during mode changes */
    body.switching-modes #main-table tr {
        transition: none !important;
    }
    body.switching-modes #main-table td {
        transition: none !important;
    }
    
    /* Dimmed filter row styling */
    #threshold-slider-row.dimmed {
        opacity: 0.5;
        transition: opacity 0.2s ease-out;
    }
    #threshold-slider-row:not(.dimmed) {
        opacity: 1;
        transition: opacity 0.2s ease-out;
    }
    
    /* Fix sticky cell background in threshold row */
    #threshold-slider-row td.sticky.left-0 {
        background-color: rgb(239, 246, 255) !important; /* Solid blue-50 */
        opacity: 1 !important; /* Always fully opaque */
    }
    .dark #threshold-slider-row td.sticky.left-0 {
        background-color: rgb(23, 37, 84) !important; /* Solid dark blue */
        opacity: 1 !important;
    }
    /* Global alert row should have white background */
    #global-alert-thresholds-row td.sticky.left-0 {
        background-color: rgb(255, 255, 255) !important; /* white */
        opacity: 1 !important;
    }
    .dark #global-alert-thresholds-row td.sticky.left-0 {
        background-color: rgb(31, 41, 55) !important; /* gray-800 */
        opacity: 1 !important;
    }
    
    /* Make the content inside sticky cell match row opacity */
    #threshold-slider-row.dimmed td.sticky.left-0 > *,
    #global-alert-thresholds-row.dimmed td.sticky.left-0 > * {
        opacity: 0.5;
    }
    #threshold-slider-row:not(.dimmed) td.sticky.left-0 > *,
    #global-alert-thresholds-row:not(.dimmed) td.sticky.left-0 > * {
        opacity: 1;
    }
    
    /* Ensure sticky column borders don't overlap with scrollbar */
    .table-container {
        position: relative;
    }
    
    /* Consistent border styling for all sticky columns */
    .sticky.left-0.border-r {
        border-right-width: 1px;
    }
    
    /* Ensure sticky columns stay above scrolling content */
    th.sticky.left-0 {
        z-index: 20 !important;
    }
    
    td.sticky.left-0 {
        z-index: 15 !important;
    }
    
    /* Special rows need higher z-index */
    #threshold-slider-row td.sticky.left-0,
    #global-alert-thresholds-row td.sticky.left-0 {
        z-index: 16 !important;
    }
    
    /* Consistent sticky column styling across all devices */
    /* Remove the broken border from sticky cells */
    .sticky.left-0 {
        border-right: none !important;
    }
    
    /* Add a proper separator using box-shadow that stays with the sticky column */
    th.sticky.left-0,
    td.sticky.left-0 {
        box-shadow: 2px 0 0 0 rgb(209, 213, 219);
        position: sticky !important;
        left: 0 !important;
    }
    
    .dark th.sticky.left-0,
    .dark td.sticky.left-0 {
        box-shadow: 2px 0 0 0 rgb(75, 85, 99);
    }
    
    /* Ensure proper background colors for sticky cells to prevent transparency */
    th.sticky.left-0 {
        background-color: rgb(243, 244, 246) !important; /* gray-100 */
    }
    
    .dark th.sticky.left-0 {
        background-color: rgb(55, 65, 81) !important; /* gray-700 */
    }
    
    /* Regular data rows */
    td.sticky.left-0 {
        background-color: white !important;
    }
    
    .dark td.sticky.left-0 {
        background-color: rgb(31, 41, 55) !important; /* gray-800 */
    }
    
    /* Hover state for sticky columns in regular rows */
    tr:hover td.sticky.left-0 {
        background-color: rgb(249, 250, 251) !important; /* gray-50 */
    }
    
    .dark tr:hover td.sticky.left-0 {
        background-color: rgb(55, 65, 81) !important; /* gray-700 */
    }
    
    /* Special hover states for rows with warning/critical/failed backgrounds */
    tr.bg-red-50:hover td.sticky.left-0 {
        background-color: rgb(254, 226, 226) !important; /* red-100 */
    }
    
    .dark tr.bg-red-900\/20:hover td.sticky.left-0 {
        background-color: rgba(127, 29, 29, 0.3) !important; /* red-900/30 */
    }
    
    tr.bg-yellow-50:hover td.sticky.left-0 {
        background-color: rgb(254, 240, 138) !important; /* yellow-100 */
    }
    
    .dark tr.bg-yellow-900\/20:hover td.sticky.left-0 {
        background-color: rgba(113, 63, 18, 0.3) !important; /* yellow-900/30 */
    }
    
    tr.bg-blue-50:hover td.sticky.left-0 {
        background-color: rgb(219, 234, 254) !important; /* blue-100 */
    }
    
    .dark tr.bg-blue-900\/20:hover td.sticky.left-0 {
        background-color: rgba(30, 64, 175, 0.3) !important; /* blue-900/30 */
    }
    
    /* Node/group header rows - use lighter background for all tables */
    .node-header td.sticky.left-0,
    .node-storage-header td.sticky.left-0,
    tr.bg-gray-100.font-semibold td.sticky.left-0 {
        background-color: rgb(249, 250, 251) !important; /* gray-50 */
    }
    
    .dark .node-header td.sticky.left-0,
    .dark .node-storage-header td.sticky.left-0,
    .dark tr.font-semibold td.sticky.left-0 {
        background-color: rgb(43, 53, 68) !important; /* Matches gray-700/50 over gray-800 */
    }
    
    
    /* Special rows need their specific colors - solid backgrounds */
    #threshold-slider-row td.sticky.left-0 {
        background-color: rgb(239, 246, 255) !important; /* blue-50 */
    }
    .dark #threshold-slider-row td.sticky.left-0 {
        background-color: rgb(30, 41, 66) !important; /* blue-900 solid */
    }
    
    /* Global alert row has white background */
    #global-alert-thresholds-row td.sticky.left-0 {
        background-color: rgb(255, 255, 255) !important; /* white */
    }
    .dark #global-alert-thresholds-row td.sticky.left-0 {
        background-color: rgb(31, 41, 55) !important; /* gray-800 */
    }
    
    /* Fix sticky column jitter in alerts mode by ensuring cells maintain consistent dimensions */
    .alerts-mode #main-table td {
        vertical-align: middle;
    }
    
    /* Remove any transforms or will-change from inputs that might cause layer issues */
    .alerts-mode input[type="range"],
    .alerts-mode select {
        transform: none !important;
        will-change: auto !important;
    }
    
    /* Force sticky column to its own layer in alerts mode */
    .alerts-mode .sticky.left-0 {
        transform: translateZ(0);
        -webkit-transform: translateZ(0);
        backface-visibility: hidden;
        -webkit-backface-visibility: hidden;
    }
    
    /* Add border to toggle switch tracks for better visibility in light mode */
    .relative.w-9.h-5.bg-gray-200 {
        border: 1px solid #d1d5db; /* gray-300 */
    }
    
    .relative.w-11.h-6.bg-gray-200 {
        border: 1px solid #d1d5db; /* gray-300 */
    }
    
    /* Ensure dark mode tracks don't have unnecessary borders */
    .dark .relative.w-9.h-5.bg-gray-700,
    .dark .relative.w-11.h-6.bg-gray-700 {
        border: 1px solid transparent;
    }
    
    /* Add outline to range input sliders for better visibility in light mode */
    input[type="range"].bg-gray-300,
    input[type="range"].custom-slider {
        outline: 1px solid #d1d5db; /* gray-300 */
        outline-offset: -1px;
    }
    
    /* Darker outline for better contrast in light mode */
    input[type="range"]::-webkit-slider-track {
        box-shadow: inset 0 0 0 1px #d1d5db; /* gray-300 */
    }
    
    input[type="range"]::-moz-range-track {
        box-shadow: inset 0 0 0 1px #d1d5db; /* gray-300 */
    }
    
    /* Remove outline in dark mode where contrast is already good */
    .dark input[type="range"].bg-gray-600,
    .dark input[type="range"].custom-slider {
        outline: none;
    }
    
    .dark input[type="range"]::-webkit-slider-track {
        box-shadow: none;
    }
    
    .dark input[type="range"]::-moz-range-track {
        box-shadow: none;
    }
    
  </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 p-2 font-sans">
  <div id="loading-overlay" class="fixed inset-0 z-50 flex items-center justify-center bg-gray-100 dark:bg-gray-900 bg-opacity-80 dark:bg-opacity-80">
    <div class="text-center">
       <svg width="40" height="40" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg" class="pulse-logo mx-auto mb-2">
        <title>Pulse Logo</title>
        <circle class="pulse-bg" cx="128" cy="128" r="122"/>
        <circle class="pulse-ring pulse-logo-circle" cx="128" cy="128" r="84"/>
        <circle class="pulse-center pulse-logo-circle" cx="128" cy="128" r="26"/>
      </svg>
      <p class="text-lg font-medium text-gray-700 dark:text-gray-300">Loading data...</p>
    </div>
  </div>
  <div class="container w-[95%] max-w-screen-xl mx-auto">
    <div class="header flex flex-row justify-between items-center mb-2">
      <div class="hidden md:block md:flex-1"></div>
      <div class="flex items-center gap-1 flex-none">
          <svg width="20" height="20" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg" class="pulse-logo">
            <title>Pulse Logo</title>
            <circle class="pulse-bg" cx="128" cy="128" r="122"/>
            <circle class="pulse-ring pulse-logo-circle" cx="128" cy="128" r="84"/>
            <circle class="pulse-center pulse-logo-circle" cx="128" cy="128" r="26"/>
          </svg>
          <span class="text-lg font-medium text-gray-800 dark:text-gray-200">Pulse</span>
          <span id="version-badge" class="text-xs font-bold text-orange-600 dark:text-orange-400 bg-orange-100 dark:bg-orange-900 px-1 py-0.5 rounded ml-1 hidden"></span>
        </div>
      <div class="header-controls flex justify-end items-center gap-4 md:flex-1">
        <button id="settings-button" type="button" class="p-1 h-11 w-11 sm:h-auto sm:w-auto rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none" title="Settings" aria-label="Open settings">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle>
          </svg>
        </button>
        <div id="connection-status" class="status disconnected text-xs px-2 py-1 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300" role="status" aria-live="polite">Disconnected</div>
      </div>
    </div>
    <div class="tabs flex mb-2 border-b border-gray-300 dark:border-gray-700 overflow-x-auto overflow-y-hidden whitespace-nowrap scrollbar" role="tablist" aria-label="Main navigation tabs">
      <div class="tab active px-3 py-1.5 cursor-pointer bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 border-b-0 rounded-t text-sm -mb-px flex items-center gap-1.5" data-tab="main" role="tab" aria-selected="true" aria-controls="main" tabindex="0" title="Real-time status of all VMs and containers">
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block align-middle"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
          <span>Main</span>
      </div>
      <div class="tab px-3 py-1.5 cursor-pointer bg-gray-100 dark:bg-gray-700/50 border-transparent text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-t flex items-center gap-1.5" data-tab="storage" role="tab" aria-selected="false" aria-controls="storage" tabindex="-1" title="Storage usage and status across all nodes">
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block align-middle"><ellipse cx="12" cy="5" rx="9" ry="3"></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path></svg>
          <span>Storage</span>
      </div>
      <div class="tab px-3 py-1.5 cursor-pointer bg-gray-100 dark:bg-gray-700/50 border-transparent text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-t flex items-center gap-1.5" data-tab="unified" role="tab" aria-selected="false" aria-controls="unified" tabindex="-1" title="All backups, snapshots, and remote backups in one view">
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block align-middle">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="3" y1="9" x2="21" y2="9"></line>
              <line x1="9" y1="21" x2="9" y2="9"></line>
          </svg>
          <span>Backups</span>
      </div>
    </div>
    <div id="main" class="tab-content block bg-white dark:bg-gray-800 rounded-b rounded-tr shadow mb-2">
      <!-- Nested Tab Content START -->
      <div id="nested-tab-dashboard" class="nested-tab-content p-3">

          <div id="node-summary-cards-container" class="mb-3">
            <!-- Node summary cards will be injected here -->
            <p class="text-sm text-gray-500 dark:text-gray-400">Loading node summary...</p>
          </div>

          <div class="dashboard-filter flex flex-col gap-2 mb-3 p-2 bg-gray-50 dark:bg-gray-700/50 border border-gray-200 dark:border-gray-700 rounded">
            <div class="filter-controls-wrapper flex flex-wrap items-center gap-2">
              <input type="text" id="dashboard-search" placeholder="Search Name, ID, Node (use ',' for OR)" aria-label="Search virtual machines and containers" class="flex-1 min-w-[150px] max-w-full p-1 px-2 h-7 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 outline-none" />
              <button id="reset-filters-button" title="Reset Filters & Sort (Esc)" class="flex items-center justify-center p-1 h-11 w-11 sm:h-7 sm:w-7 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none transition-colors flex-shrink-0">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class=""><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>
              </button>
              <div class="flex items-center gap-1 flex-shrink-0 relative">
                <span class="text-xs text-gray-600 dark:text-gray-400 font-medium hidden sm:inline">View:</span>
                <div class="segmented-control inline-flex border border-gray-300 dark:border-gray-600 rounded flex-shrink-0">
                  <label class="relative">
                    <input type="checkbox" id="toggle-charts-checkbox" class="hidden peer">
                    <span class="flex items-center justify-center px-3 py-2 sm:px-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 peer-checked:bg-blue-100 dark:peer-checked:bg-blue-800/50 peer-checked:text-blue-700 dark:peer-checked:text-blue-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none  transition-colors">
                      <span>Charts</span>
                    </span>
                  </label>
                  <label class="relative">
                    <input type="checkbox" id="toggle-thresholds-checkbox" class="hidden peer">
                    <span class="flex items-center justify-center px-3 py-2 sm:px-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-gray-300 dark:border-gray-600 peer-checked:bg-blue-100 dark:peer-checked:bg-blue-800/50 peer-checked:text-blue-700 dark:peer-checked:text-blue-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none  transition-colors">
                      <span>Thresholds</span>
                    </span>
                  </label>
                  <label class="relative">
                    <input type="checkbox" id="toggle-alerts-checkbox" class="hidden peer">
                    <span class="flex items-center justify-center px-3 py-2 sm:px-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-gray-300 dark:border-gray-600 peer-checked:bg-blue-100 dark:peer-checked:bg-blue-800/50 peer-checked:text-blue-700 dark:peer-checked:text-blue-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none  transition-colors">
                      <span>Alerts</span>
                    </span>
                  </label>
                </div>
              </div>
              <!-- Hidden select element to maintain compatibility -->
              <select id="time-range-select" class="hidden">
                <option value="1">Last 1 minute</option>
                <option value="5">Last 5 minutes</option>
                <option value="15">Last 15 minutes</option>
                <option value="30">Last 30 minutes</option>
                <option value="60" selected>Last 1 hour</option>
                <option value="120">Last 2 hours</option>
                <option value="240">Last 4 hours</option>
                <option value="480">Last 8 hours</option>
                <option value="720">Last 12 hours</option>
                <option value="1440">Last 24 hours</option>
                <option value="2880">Last 2 days</option>
                <option value="10080">Last 7 days</option>
              </select>
              <div class="h-4 w-px bg-gray-300 dark:bg-gray-600 hidden lg:block flex-shrink-0"></div>
              <div class="flex items-center gap-1 flex-shrink-0">
                <span class="text-xs text-gray-600 dark:text-gray-400 font-medium hidden lg:inline">Display:</span>
                <div class="segmented-control inline-flex border border-gray-300 dark:border-gray-600 rounded overflow-hidden flex-shrink-0">
                  <input type="radio" id="group-grouped" name="group-filter" value="grouped" class="hidden peer/grouped" checked>
                  <label for="group-grouped" class="flex items-center justify-center px-2 py-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 peer-checked/grouped:bg-blue-100 dark:peer-checked/grouped:bg-blue-800/50 peer-checked/grouped:text-blue-700 dark:peer-checked/grouped:text-blue-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none ">
                    <span>Grouped</span>
                  </label>
                  <input type="radio" id="group-list" name="group-filter" value="list" class="hidden peer/list">
                  <label for="group-list" class="flex items-center justify-center px-2 py-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-gray-300 dark:border-gray-600 peer-checked/list:bg-blue-100 dark:peer-checked/list:bg-blue-800/50 peer-checked/list:text-blue-700 dark:peer-checked/list:text-blue-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none ">
                    <span>List</span>
                  </label>
                </div>
                </div>
              <div class="flex items-center gap-1 flex-shrink-0">
                <div class="segmented-control inline-flex border border-gray-300 dark:border-gray-600 rounded overflow-hidden flex-shrink-0">
                  <input type="radio" id="filter-all" name="type-filter" value="all" class="hidden peer/all" checked>
                  <label for="filter-all" class="flex items-center justify-center px-2 py-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 peer-checked/all:bg-blue-100 dark:peer-checked/all:bg-blue-800/50 peer-checked/all:text-blue-700 dark:peer-checked/all:text-blue-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none ">
                    <span class="inline">All</span>
                  </label>
                  <input type="radio" id="filter-vm" name="type-filter" value="vm" class="hidden peer/vm">
                  <label for="filter-vm" class="flex items-center justify-center px-2 py-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-gray-300 dark:border-gray-600 peer-checked/vm:bg-blue-100 dark:peer-checked/vm:bg-blue-800/50 peer-checked/vm:text-blue-700 dark:peer-checked/vm:text-blue-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none ">
                    <span>VM</span>
                  </label>
                  <input type="radio" id="filter-lxc" name="type-filter" value="lxc" class="hidden peer/lxc">
                  <label for="filter-lxc" class="flex items-center justify-center px-2 py-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-gray-300 dark:border-gray-600 peer-checked/lxc:bg-green-100 dark:peer-checked/lxc:bg-green-800/50 peer-checked/lxc:text-green-700 dark:peer-checked/lxc:text-green-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none ">
                    <span>LXC</span>
                  </label>
                </div>
              </div>
              <div class="flex items-center gap-1 flex-shrink-0">
                <div class="segmented-control inline-flex border border-gray-300 dark:border-gray-600 rounded overflow-hidden flex-shrink-0">
                  <input type="radio" id="filter-status-all" name="status-filter" value="all" class="hidden peer/status-all" checked>
                  <label for="filter-status-all" class="flex items-center justify-center px-2 py-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 peer-checked/status-all:bg-blue-100 dark:peer-checked/status-all:bg-blue-800/50 peer-checked/status-all:text-blue-700 dark:peer-checked/status-all:text-blue-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none ">
                    <span class="inline">All</span>
                  </label>
                  <input type="radio" id="filter-status-running" name="status-filter" value="running" class="hidden peer/status-running">
                  <label for="filter-status-running" class="flex items-center justify-center px-2 py-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-gray-300 dark:border-gray-600 peer-checked/status-running:bg-green-100 dark:peer-checked/status-running:bg-green-800/50 peer-checked/status-running:text-green-700 dark:peer-checked/status-running:text-green-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none ">
                    <span>Running</span>
                  </label>
                  <input type="radio" id="filter-status-stopped" name="status-filter" value="stopped" class="hidden peer/status-stopped">
                  <label for="filter-status-stopped" class="flex items-center justify-center px-2 py-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-gray-300 dark:border-gray-600 peer-checked/status-stopped:bg-gray-100 dark:peer-checked/status-stopped:bg-gray-600/50 peer-checked/status-stopped:text-gray-700 dark:peer-checked/status-stopped:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none ">
                    <span>Stopped</span>
                  </label>
                </div>
              </div>
            </div>
          </div>


          <div class="table-container overflow-x-auto mb-2 border border-gray-200 dark:border-gray-700 rounded overflow-hidden scrollbar relative">
            <!-- Mobile scroll hint -->
            <div class="fixed bottom-4 right-4 bg-blue-500 text-white text-[11px] px-3 py-1.5 rounded-full md:hidden animate-pulse shadow-lg z-50 pointer-events-none" id="scroll-hint" style="display: none;">
                ← Swipe for more →
            </div>
            <style>
                /* Node header rows need more specific rule to override global CSS */
                #main-table tr.bg-gray-50 td.sticky.left-0 {
                    background-color: rgb(249, 250, 251) !important; /* gray-50 - solid */
                }
                .dark #main-table tr.dark\:bg-gray-700\/50 td.sticky.left-0 {
                    /* Use a color that visually matches gray-700/50 over gray-800 background */
                    background-color: rgb(43, 53, 68) !important; /* Between gray-800 and gray-700 */
                }
            </style>
            <table id="main-table" class="w-full min-w-[1100px] table-fixed text-xs sm:text-sm" role="table" aria-label="Virtual machines and containers">
                <colgroup>
                  <col class="name-col" style="width: 150px;">
                  <col class="type-col" style="width: 50px;">
                  <col class="id-col" style="width: 60px;">
                  <col class="uptime-col" style="width: 70px;">
                  <col class="usage-col" style="width: 120px;">
                  <col class="usage-col" style="width: 120px;">
                  <col class="usage-col" style="width: 120px;">
                  <col class="net-disk-col" style="width: 95px;">
                  <col class="net-disk-col" style="width: 95px;">
                  <col class="net-disk-col" style="width: 95px;">
                  <col class="net-disk-col" style="width: 95px;">
                </colgroup>
              <thead class="bg-gray-100 dark:bg-gray-800">
                <tr class="text-[10px] sm:text-xs font-medium tracking-wider text-left text-gray-600 uppercase bg-gray-100 dark:bg-gray-700 dark:text-gray-300 border-b border-gray-300 dark:border-gray-600">
                  <th class="sticky left-0 top-0 bg-gray-100 dark:bg-gray-700 z-20 sortable p-1 px-2" data-sort="name" style="width: 150px;">Name</th>
                  <th class="sticky top-0 bg-gray-100 dark:bg-gray-700 z-10 p-1 px-2" style="width: 50px;">Type</th>
                  <th class="sticky top-0 bg-gray-100 dark:bg-gray-700 z-10 sortable p-1 px-2" data-sort="id" style="width: 60px;">VMID</th>
                  <th class="sticky top-0 bg-gray-100 dark:bg-gray-700 z-10 sortable p-1 px-2" data-sort="uptime" style="width: 70px;" title="Uptime">Up</th>
                  <th class="sticky top-0 bg-gray-100 dark:bg-gray-700 z-10 sortable p-1 px-2" data-sort="cpu" style="width: 120px;">CPU</th>
                  <th class="sticky top-0 bg-gray-100 dark:bg-gray-700 z-10 sortable p-1 px-2" data-sort="memory" style="width: 120px;">Memory</th>
                  <th class="sticky top-0 bg-gray-100 dark:bg-gray-700 z-10 sortable p-1 px-2" data-sort="disk" style="width: 120px;">Disk</th>
                  <th class="sticky top-0 bg-gray-100 dark:bg-gray-700 z-10 sortable p-1 px-2" data-sort="diskread" style="width: 95px;">Read</th>
                  <th class="sticky top-0 bg-gray-100 dark:bg-gray-700 z-10 sortable p-1 px-2" data-sort="diskwrite" style="width: 95px;">Write</th>
                  <th class="sticky top-0 bg-gray-100 dark:bg-gray-700 z-10 sortable p-1 px-2" data-sort="netin" style="width: 95px;">Net In</th>
                  <th class="sticky top-0 bg-gray-100 dark:bg-gray-700 z-10 sortable p-1 px-2" data-sort="netout" style="width: 95px;">Net Out</th>
                </tr>
                <tr id="threshold-slider-row" class="hidden bg-white dark:bg-gray-800 border-b border-gray-300 dark:border-gray-600">
                  <td class="sticky left-0 z-10 py-1 px-2 align-middle bg-white dark:bg-gray-800">
                    <div class="flex flex-col gap-1">
                      <div class="flex items-center justify-between">
                        <span class="text-xs text-blue-700 dark:text-blue-300 font-semibold">FILTERS</span>
                        <button id="reset-thresholds" class="text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 px-1 py-0.5 border border-blue-300 dark:border-blue-600 rounded hover:bg-blue-100 dark:hover:bg-blue-800/20">
                          Reset
                        </button>
                      </div>
                    </div>
                  </td>
                  <td class="py-1 px-2 align-middle">-</td>
                  <td class="py-1 px-2 align-middle">-</td>
                  <td class="py-1 px-2 align-middle">-</td>
                  <td class="py-1 px-2 align-middle">
                    <div class="flex flex-row items-center gap-1">
                      <input type="range" id="threshold-slider-cpu" min="0" max="100" step="1" value="0" class="custom-slider w-full h-3 rounded-full bg-gray-300 dark:bg-gray-600 appearance-none cursor-pointer flex-grow">
                    </div>
                  </td>
                  <td class="py-1 px-2 align-middle">
                    <div class="flex flex-row items-center gap-1">
                      <input type="range" id="threshold-slider-memory" min="0" max="100" step="1" value="0" class="custom-slider w-full h-3 rounded-full bg-gray-300 dark:bg-gray-600 appearance-none cursor-pointer flex-grow">
                    </div>
                  </td>
                  <td class="py-1 px-2 align-middle">
                    <div class="flex flex-row items-center gap-1">
                      <input type="range" id="threshold-slider-disk" min="0" max="100" step="1" value="0" class="custom-slider w-full h-3 rounded-full bg-gray-300 dark:bg-gray-600 appearance-none cursor-pointer flex-grow">
                    </div>
                  </td>
                  <td class="py-1 px-2 align-middle">
                    <select id="threshold-select-diskread" class="threshold-select px-1 py-0 h-5 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-[10px] w-full focus:outline-none focus:ring-1 focus:ring-blue-500">
                        <option value="0" selected>Any</option>
                        <option value="1048576">&gt; 1 MB/s</option>
                        <option value="10485760">&gt; 10 MB/s</option>
                        <option value="52428800">&gt; 50 MB/s</option>
                        <option value="104857600">&gt; 100 MB/s</option>
                    </select>
                  </td>
                  <td class="py-1 px-2 align-middle">
                    <select id="threshold-select-diskwrite" class="threshold-select px-1 py-0 h-5 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-[10px] w-full focus:outline-none focus:ring-1 focus:ring-blue-500">
                        <option value="0" selected>Any</option>
                        <option value="1048576">&gt; 1 MB/s</option>
                        <option value="10485760">&gt; 10 MB/s</option>
                        <option value="52428800">&gt; 50 MB/s</option>
                        <option value="104857600">&gt; 100 MB/s</option>
                    </select>
                  </td>
                  <td class="py-1 px-2 align-middle">
                    <select id="threshold-select-netin" class="threshold-select px-1 py-0 h-5 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-[10px] w-full focus:outline-none focus:ring-1 focus:ring-blue-500">
                        <option value="0" selected>Any</option>
                        <option value="1048576">&gt; 1 MB/s</option>
                        <option value="10485760">&gt; 10 MB/s</option>
                        <option value="52428800">&gt; 50 MB/s</option>
                        <option value="104857600">&gt; 100 MB/s</option>
                    </select>
                  </td>
                  <td class="py-1 px-2 align-middle">
                    <select id="threshold-select-netout" class="threshold-select px-1 py-0 h-5 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-[10px] w-full focus:outline-none focus:ring-1 focus:ring-blue-500">
                        <option value="0" selected>Any</option>
                        <option value="1048576">&gt; 1 MB/s</option>
                        <option value="10485760">&gt; 10 MB/s</option>
                        <option value="52428800">&gt; 50 MB/s</option>
                        <option value="104857600">&gt; 100 MB/s</option>
                    </select>
                  </td>
                </tr>
                <!-- Global Alert Thresholds Row -->
                <tr id="global-alert-thresholds-row" class="hidden bg-white dark:bg-gray-800 border-b border-gray-300 dark:border-gray-600">
                  <td class="sticky left-0 z-10 py-1 px-2 align-middle bg-white dark:bg-gray-800">
                    <div class="flex flex-col gap-1">
                      <div class="flex items-center justify-between">
                        <span class="text-xs text-blue-700 dark:text-blue-300 font-semibold">GLOBAL</span>
                        <button id="reset-global-thresholds" class="text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 px-1 py-0.5 border border-blue-300 dark:border-blue-600 rounded hover:bg-blue-100 dark:hover:bg-blue-800/20">
                          Reset
                        </button>
                      </div>
                    </div>
                  </td>
                  <td class="py-1 px-2 align-middle">-</td>
                  <td class="py-1 px-2 align-middle">-</td>
                  <td class="py-1 px-2 align-middle">-</td>
                  <td class="py-1 px-2 align-middle" id="global-cpu-cell"></td>
                  <td class="py-1 px-2 align-middle" id="global-memory-cell"></td>
                  <td class="py-1 px-2 align-middle" id="global-disk-cell"></td>
                  <td class="py-1 px-2 align-middle" id="global-diskread-cell"></td>
                  <td class="py-1 px-2 align-middle" id="global-diskwrite-cell"></td>
                  <td class="py-1 px-2 align-middle" id="global-netin-cell"></td>
                  <td class="py-1 px-2 align-middle" id="global-netout-cell"></td>
                </tr>
              </thead>
              <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                <tr>
                  <td colspan="11" class="p-4 text-center text-gray-500 dark:text-gray-400">Loading data...</td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Threshold Filter Settings -->
          <div id="threshold-filter-controls" class="hidden mt-3 px-4 py-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-600 rounded-md">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-6">
                <span class="text-sm text-blue-700 dark:text-blue-300 font-semibold">Threshold Settings</span>
                <label class="inline-flex items-center gap-2 cursor-pointer" title="Hide guests that don't meet thresholds instead of dimming">
                  <span class="text-xs text-blue-700 dark:text-blue-300">Hide non-matching:</span>
                  <input type="checkbox" id="threshold-hide-mode" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                </label>
              </div>
            </div>
          </div>

          <!-- Charts Mode Controls -->
          <div id="charts-mode-controls" class="hidden mt-3 px-4 py-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-600 rounded-md">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
              <div class="flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-6">
                <span class="text-sm text-blue-700 dark:text-blue-300 font-semibold">Chart Settings</span>
                <div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3">
                  <span class="text-xs text-blue-700 dark:text-blue-300">Time Range:</span>
                  <div class="overflow-x-auto">
                    <div class="segmented-control inline-flex border border-blue-300 dark:border-blue-600 rounded overflow-hidden">
                    <input type="radio" id="time-5m" name="time-range" value="5" class="hidden peer/5m">
                    <label for="time-5m" data-time-range="5" class="flex items-center justify-center px-3 py-1 text-xs cursor-pointer bg-white dark:bg-gray-800 peer-checked/5m:bg-gray-100 dark:peer-checked/5m:bg-gray-700 peer-checked/5m:text-blue-600 dark:peer-checked/5m:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-700 select-none">5m</label>
                    
                    <input type="radio" id="time-15m" name="time-range" value="15" class="hidden peer/15m">
                    <label for="time-15m" data-time-range="15" class="flex items-center justify-center px-3 py-1 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-blue-300 dark:border-blue-600 peer-checked/15m:bg-gray-100 dark:peer-checked/15m:bg-gray-700 peer-checked/15m:text-blue-600 dark:peer-checked/15m:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-700 select-none">15m</label>
                    
                    <input type="radio" id="time-30m" name="time-range" value="30" class="hidden peer/30m">
                    <label for="time-30m" data-time-range="30" class="flex items-center justify-center px-3 py-1 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-blue-300 dark:border-blue-600 peer-checked/30m:bg-gray-100 dark:peer-checked/30m:bg-gray-700 peer-checked/30m:text-blue-600 dark:peer-checked/30m:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-700 select-none">30m</label>
                    
                    <input type="radio" id="time-1h" name="time-range" value="60" class="hidden peer/1h" checked>
                    <label for="time-1h" data-time-range="60" class="flex items-center justify-center px-3 py-1 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-blue-300 dark:border-blue-600 peer-checked/1h:bg-gray-100 dark:peer-checked/1h:bg-gray-700 peer-checked/1h:text-blue-600 dark:peer-checked/1h:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-700 select-none">1h</label>
                    
                    <input type="radio" id="time-4h" name="time-range" value="240" class="hidden peer/4h">
                    <label for="time-4h" data-time-range="240" class="flex items-center justify-center px-3 py-1 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-blue-300 dark:border-blue-600 peer-checked/4h:bg-gray-100 dark:peer-checked/4h:bg-gray-700 peer-checked/4h:text-blue-600 dark:peer-checked/4h:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-700 select-none">4h</label>
                    
                    <input type="radio" id="time-12h" name="time-range" value="720" class="hidden peer/12h">
                    <label for="time-12h" data-time-range="720" class="flex items-center justify-center px-3 py-1 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-blue-300 dark:border-blue-600 peer-checked/12h:bg-gray-100 dark:peer-checked/12h:bg-gray-700 peer-checked/12h:text-blue-600 dark:peer-checked/12h:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-700 select-none">12h</label>
                    
                    <input type="radio" id="time-24h" name="time-range" value="1440" class="hidden peer/24h">
                    <label for="time-24h" data-time-range="1440" class="flex items-center justify-center px-3 py-1 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-blue-300 dark:border-blue-600 peer-checked/24h:bg-gray-100 dark:peer-checked/24h:bg-gray-700 peer-checked/24h:text-blue-600 dark:peer-checked/24h:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-700 select-none">24h</label>
                    
                    <input type="radio" id="time-7d" name="time-range" value="10080" class="hidden peer/7d">
                    <label for="time-7d" data-time-range="10080" class="flex items-center justify-center px-3 py-1 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-blue-300 dark:border-blue-600 peer-checked/7d:bg-gray-100 dark:peer-checked/7d:bg-gray-700 peer-checked/7d:text-blue-600 dark:peer-checked/7d:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-700 select-none">7d</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Alert Mode Controls -->
          <div id="alert-mode-controls" class="hidden mt-3 px-4 py-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-600 rounded-md">
            <!-- Main Controls -->
            <div class="space-y-4">
              <!-- Top row with main controls -->
              <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
                <div class="flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-6">
                  <span class="text-sm text-blue-700 dark:text-blue-300 font-semibold">Alert Settings</span>
                  <div class="flex flex-wrap items-center gap-3">
                    <div class="flex items-center gap-2">
                      <span class="text-xs text-blue-700 dark:text-blue-300" title="How long thresholds must be exceeded before triggering alerts">Duration:</span>
                      <select id="alert-duration-select" class="text-xs bg-white dark:bg-gray-800 border border-blue-300 dark:border-blue-600 rounded px-2 py-1 text-blue-700 dark:text-blue-300" title="How long thresholds must be exceeded before triggering alerts">
                        <option value="0" selected>Instant</option>
                        <option value="10000">10s</option>
                        <option value="30000">30s</option>
                        <option value="60000">1m</option>
                        <option value="300000">5m</option>
                        <option value="600000">10m</option>
                      </select>
                    </div>
                    <label class="inline-flex items-center gap-2 cursor-pointer" title="Automatically clear alerts when thresholds return to normal">
                      <span class="text-xs text-blue-700 dark:text-blue-300">Auto-resolve:</span>
                      <input type="checkbox" id="alert-auto-resolve-toggle" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600" checked>
                    </label>
                  </div>
                </div>
                <div class="flex items-center gap-3 sm:ml-auto">
                  <span id="alert-save-message" class="text-xs text-blue-600 dark:text-blue-400"></span>
                  <button id="save-alert-config" class="px-3 py-1 text-xs bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors">
                    Save
                  </button>
                </div>
              </div>
              
              
              <!-- Cooldown Settings in a grid layout -->
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                <!-- Email Settings Card -->
                <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg p-4">
                  <div class="flex items-center justify-between mb-4">
                    <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300">Email Notifications</h4>
                    <label class="inline-flex items-center gap-2 cursor-pointer">
                      <input type="checkbox" id="alert-email-toggle" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    </label>
                  </div>
                  <div id="email-cooldown-settings" style="display: none;">
                    <div class="space-y-3 mb-4">
                      <div class="flex items-center justify-between">
                        <label class="text-xs text-gray-600 dark:text-gray-400" for="alert-cooldown-minutes">Time between emails:</label>
                        <div class="flex items-center gap-1 shrink-0">
                          <input type="number" id="alert-cooldown-minutes" min="1" max="120" value="15" class="w-16 px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-1 focus:ring-blue-500">
                          <span class="text-xs text-gray-500 dark:text-gray-500 w-6">min</span>
                        </div>
                      </div>
                      <div class="flex items-center justify-between">
                        <label class="text-xs text-gray-600 dark:text-gray-400" for="alert-debounce-minutes">Wait before first email:</label>
                        <div class="flex items-center gap-1 shrink-0">
                          <input type="number" id="alert-debounce-minutes" min="0" max="30" value="2" class="w-16 px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-1 focus:ring-blue-500">
                          <span class="text-xs text-gray-500 dark:text-gray-500 w-6">min</span>
                        </div>
                      </div>
                      <div class="flex items-center justify-between">
                        <label class="text-xs text-gray-600 dark:text-gray-400" for="alert-max-emails-hour">Max emails per hour:</label>
                        <div class="flex items-center gap-1 shrink-0">
                          <input type="number" id="alert-max-emails-hour" min="1" max="20" value="4" class="w-16 px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-1 focus:ring-blue-500">
                          <span class="text-xs text-gray-500 dark:text-gray-500 w-6">/hr</span>
                        </div>
                      </div>
                    </div>
                    <button id="test-email-alert" class="w-full px-3 py-1.5 text-xs bg-gray-600 hover:bg-gray-700 text-white rounded transition-colors" title="Send a test email notification">
                      Test Email
                    </button>
                  </div>
                </div>
                
                <!-- Webhook Settings Card -->
                <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg p-4">
                  <div class="flex items-center justify-between mb-4">
                    <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300">Webhook Notifications</h4>
                    <label class="inline-flex items-center gap-2 cursor-pointer">
                      <input type="checkbox" id="alert-webhook-toggle" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    </label>
                  </div>
                  <div id="webhook-cooldown-settings" style="display: none;">
                    <div class="space-y-3 mb-4">
                      <div class="flex items-center justify-between">
                        <label class="text-xs text-gray-600 dark:text-gray-400" for="webhook-cooldown-minutes">Time between webhooks:</label>
                        <div class="flex items-center gap-1 shrink-0">
                          <input type="number" id="webhook-cooldown-minutes" min="1" max="120" value="5" class="w-16 px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-1 focus:ring-blue-500">
                          <span class="text-xs text-gray-500 dark:text-gray-500 w-6">min</span>
                        </div>
                      </div>
                      <div class="flex items-center justify-between">
                        <label class="text-xs text-gray-600 dark:text-gray-400" for="webhook-debounce-minutes">Wait before first webhook:</label>
                        <div class="flex items-center gap-1 shrink-0">
                          <input type="number" id="webhook-debounce-minutes" min="0" max="30" value="1" class="w-16 px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-1 focus:ring-blue-500">
                          <span class="text-xs text-gray-500 dark:text-gray-500 w-6">min</span>
                        </div>
                      </div>
                      <div class="flex items-center justify-between">
                        <label class="text-xs text-gray-600 dark:text-gray-400" for="webhook-max-calls-hour">Max calls per hour:</label>
                        <div class="flex items-center gap-1 shrink-0">
                          <input type="number" id="webhook-max-calls-hour" min="1" max="50" value="10" class="w-16 px-2 py-1 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-1 focus:ring-blue-500">
                          <span class="text-xs text-gray-500 dark:text-gray-500 w-6">/hr</span>
                        </div>
                      </div>
                    </div>
                    <button id="test-webhook-alert" class="w-full px-3 py-1.5 text-xs bg-gray-600 hover:bg-gray-700 text-white rounded transition-colors" title="Send a test webhook notification">
                      Test Webhook
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <span id="dashboard-status-text" class="text-xs text-gray-500 dark:text-gray-400 mt-2">Loading dashboard data...</span>

          <!-- Separator -->
          <hr class="border-gray-200 dark:border-gray-700 my-2">

      </div>
    </div>

    <div id="storage" class="tab-content hidden bg-white dark:bg-gray-800 rounded-b rounded-tr shadow mb-2">
      <div class="p-3">
        <div id="storage-info-content">
          <p class="text-gray-500 dark:text-gray-400 p-4 text-center">Loading storage data...</p>
        </div>
      </div>
    </div>
    
    <div id="snapshots" class="tab-content hidden bg-white dark:bg-gray-800 rounded-b rounded-tr shadow mb-2">
      <div class="p-3">
        <div id="snapshots-content">
          <p class="text-gray-500 dark:text-gray-400 p-4 text-center">Loading snapshots data...</p>
        </div>
      </div>
    </div>
    
    <div id="backups" class="tab-content hidden bg-white dark:bg-gray-800 rounded-b rounded-tr shadow mb-2">
      <div class="p-3">
        <div id="backups-content">
          <p class="text-gray-500 dark:text-gray-400 p-4 text-center">Loading backups data...</p>
        </div>
      </div>
    </div>
    
    
    <div id="pbs" class="tab-content hidden bg-white dark:bg-gray-800 rounded-b rounded-tr shadow mb-2">
      <div class="p-3">
        <div id="pbs-content">
          <p class="text-gray-500 dark:text-gray-400 p-4 text-center">Loading PBS data...</p>
        </div>
      </div>
    </div>
    
    <div id="unified" class="tab-content hidden bg-white dark:bg-gray-800 rounded-b rounded-tr shadow mb-2">
      <div id="tab-content-unified" class="p-3">
        <div class="filter-controls filter-bar flex flex-wrap items-center gap-2 mb-3 p-2 bg-gray-50 dark:bg-gray-700/50 border border-gray-200 dark:border-gray-700 rounded">
          <input type="text" id="unified-search" placeholder="Search VMID, Name, Node, Storage (use ',' for OR)" aria-label="Search backups" class="flex-1 min-w-[150px] p-1 px-2 h-7 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 outline-none" />
          <button id="unified-reset-button" title="Reset Filters & Sort (Esc)" class="flex items-center justify-center p-1 h-11 w-11 sm:h-7 sm:w-7 text-xs border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none transition-colors flex-shrink-0">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>
          </button>
          
          <!-- Backup Type Filter -->
          <div class="flex items-center gap-1 flex-shrink-0">
            <span class="text-xs text-gray-500 dark:text-gray-400 font-medium hidden sm:inline">Backup:</span>
            <div class="segmented-control inline-flex border border-gray-300 dark:border-gray-600 rounded overflow-hidden">
              <input type="radio" id="unified-backup-all" name="unified-backup-type-filter" value="all" checked class="hidden peer/all">
              <label for="unified-backup-all" class="flex items-center justify-center px-2 py-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 peer-checked/all:bg-blue-100 dark:peer-checked/all:bg-blue-800/50 peer-checked/all:text-blue-700 dark:peer-checked/all:text-blue-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none">All</label>
              
              <input type="radio" id="unified-backup-snapshot" name="unified-backup-type-filter" value="snapshot" class="hidden peer/snapshot">
              <label for="unified-backup-snapshot" class="flex items-center justify-center px-2 py-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-gray-300 dark:border-gray-600 peer-checked/snapshot:bg-blue-100 dark:peer-checked/snapshot:bg-blue-800/50 peer-checked/snapshot:text-blue-700 dark:peer-checked/snapshot:text-blue-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none">Snapshots</label>
              
              <input type="radio" id="unified-backup-local" name="unified-backup-type-filter" value="local" class="hidden peer/local">
              <label for="unified-backup-local" class="flex items-center justify-center px-2 py-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-gray-300 dark:border-gray-600 peer-checked/local:bg-blue-100 dark:peer-checked/local:bg-blue-800/50 peer-checked/local:text-blue-700 dark:peer-checked/local:text-blue-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none">PVE</label>
              
              <input type="radio" id="unified-backup-remote" name="unified-backup-type-filter" value="remote" class="hidden peer/remote">
              <label for="unified-backup-remote" class="flex items-center justify-center px-2 py-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-gray-300 dark:border-gray-600 peer-checked/remote:bg-blue-100 dark:peer-checked/remote:bg-blue-800/50 peer-checked/remote:text-blue-700 dark:peer-checked/remote:text-blue-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none">PBS</label>
            </div>
          </div>
          
          <!-- Type Filter -->
          <div class="flex items-center gap-1 flex-shrink-0">
            <span class="text-xs text-gray-500 dark:text-gray-400 font-medium hidden sm:inline">Type:</span>
            <div class="segmented-control inline-flex border border-gray-300 dark:border-gray-600 rounded overflow-hidden">
              <input type="radio" id="unified-all" name="unified-type-filter" value="all" checked class="hidden peer/all">
              <label for="unified-all" class="flex items-center justify-center px-2 py-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 peer-checked/all:bg-blue-100 dark:peer-checked/all:bg-blue-800/50 peer-checked/all:text-blue-700 dark:peer-checked/all:text-blue-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none">All</label>
              
              <input type="radio" id="unified-vm" name="unified-type-filter" value="VM" class="hidden peer/vm">
              <label for="unified-vm" class="flex items-center justify-center px-2 py-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-gray-300 dark:border-gray-600 peer-checked/vm:bg-blue-100 dark:peer-checked/vm:bg-blue-800/50 peer-checked/vm:text-blue-700 dark:peer-checked/vm:text-blue-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none">VMs</label>
              
              <input type="radio" id="unified-lxc" name="unified-type-filter" value="LXC" class="hidden peer/lxc">
              <label for="unified-lxc" class="flex items-center justify-center px-2 py-2 sm:py-0.5 text-xs cursor-pointer bg-white dark:bg-gray-800 border-l border-gray-300 dark:border-gray-600 peer-checked/lxc:bg-green-100 dark:peer-checked/lxc:bg-green-800/50 peer-checked/lxc:text-green-700 dark:peer-checked/lxc:text-green-300 hover:bg-gray-50 dark:hover:bg-gray-700 select-none">LXCs</label>
            </div>
          </div>
        </div>
        
        <div id="unified-table" class="overflow-x-auto">
          <p class="text-gray-500 dark:text-gray-400 p-4 text-center">Loading backup data...</p>
        </div>
      </div>
    </div>
  <div id="custom-tooltip" class="custom-tooltip absolute hidden z-50 px-2 py-1 text-xs text-white bg-gray-900/90 rounded shadow-lg pointer-events-none transition-opacity duration-100"></div>
  <div id="slider-value-tooltip" class="absolute hidden z-[60] px-1.5 py-0.5 text-xs text-white bg-blue-600/90 dark:bg-blue-500/90 rounded shadow-lg pointer-events-none"></div>
  <!-- Settings Modal -->
  <div id="settings-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black bg-opacity-50 p-4">
    <div class="modal-content bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-6xl max-h-[90vh] flex flex-col m-4">
      <div class="modal-header flex justify-between items-center border-b border-gray-300 dark:border-gray-700 px-6 py-4">
        <h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100">Configuration Settings</h2>
        <button id="settings-modal-close" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
      
      <!-- Tab Navigation -->
      <div class="border-b border-gray-200 dark:border-gray-700">
        <div class="overflow-x-auto">
          <nav class="flex space-x-8 px-6" id="settings-tabs" style="width: max-content;">
            <button class="settings-tab active py-3 px-1 border-b-2 border-blue-500 text-blue-600 dark:text-blue-400 font-medium text-sm" data-tab="proxmox">
              Proxmox VE
            </button>
            <button class="settings-tab py-3 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 font-medium text-sm" data-tab="pbs">
              Backup Server
            </button>
            <button class="settings-tab py-3 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 font-medium text-sm" data-tab="notifications">
              Notifications
            </button>
            <button class="settings-tab py-3 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 font-medium text-sm" data-tab="system">
              System
            </button>
            <button class="settings-tab py-3 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 font-medium text-sm" data-tab="diagnostics">
              Diagnostics
            </button>
          </nav>
        </div>
      </div>
      
      <div id="settings-modal-body" class="overflow-y-auto flex-grow p-6 scrollbar">
        <p class="text-gray-500 dark:text-gray-400">Loading configuration...</p>
      </div>
      <div class="modal-footer border-t border-gray-300 dark:border-gray-700 px-6 py-4">
        <div class="flex gap-3 justify-end">
          <button type="button" id="settings-cancel-button" class="px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white text-sm font-medium rounded-md transition-colors">
            Cancel
          </button>
          <button type="button" id="settings-save-button" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-md transition-colors">
            Save Configuration
          </button>
        </div>
      </div>
      
    </div>
  </div>

  <div id="snapshot-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black bg-opacity-50"><div class="modal-content bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-3xl max-h-[80vh] flex flex-col"><div class="modal-header flex justify-between items-center border-b border-gray-300 dark:border-gray-700 pb-3 mb-4"><h3 id="snapshot-modal-title" class="text-lg font-semibold text-gray-900 dark:text-gray-100">Snapshot Details</h3>
        <button id="snapshot-modal-close" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg></button>
      </div>
      <div id="snapshot-modal-body" class="overflow-y-auto flex-grow scrollbar"><p>Loading snapshots...</p>
      </div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>window.PulseApp = {};</script>
  <!-- <script src="/app.js" defer></script> -->
  <script src="/js/config.js" defer></script>
  <script>
  </script>
  <script src="/js/state.js" defer></script>
  <script src="/js/utils.js" defer></script>
  <script src="/js/modalManager.js" defer></script>
  <script src="/js/apiClient.js" defer></script>
  <script src="/js/theme.js" defer></script>
  <script src="/js/tooltips.js" defer></script>
  <script src="/js/socketHandler.js" defer></script>
  <script src="/js/tabs.js" defer></script>
  <script src="/js/charts.js" defer></script>
  <script src="/js/ui/toastNotifications.js" defer></script>
  <script src="/js/ui/thresholds.js" defer></script>
  <script src="/js/ui/alerts.js" defer></script>
  <script src="/js/ui/empty-states.js" defer></script>
  <script src="/js/ui/loading-skeletons.js" defer></script>
  <script src="/js/ui/common.js" defer></script>
  <script src="/js/ui/nodes.js" defer></script>
  <script src="/js/ui/dashboard.js" defer></script>
  <script src="/js/ui/storage.js" defer></script>
  <script src="/js/ui/snapshots.js" defer></script>
  <script src="/js/ui/pve.js" defer></script>
  <script src="/js/ui/pbs.js" defer></script>
  <script src="/js/ui/backups.js" defer></script>
  <script src="/js/ui/settings.js" defer></script>
  <script src="/js/ui/chartsControls.js" defer></script>
  <script src="/js/alertsHandler.js" defer></script>
  <script src="/js/hotReload.js" defer></script>
  <script src="/js/main.js" defer></script>

  <footer class="text-center text-xs text-gray-500 py-4">
    Pulse | Version: <a href="https://github.com/rcourtman/Pulse/releases" target="_blank" rel="noopener noreferrer" id="app-version" class="text-blue-600 dark:text-blue-400 hover:underline">loading...</a>
  </footer>
</body>
</html> 